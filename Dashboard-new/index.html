<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <style>
        body{
            height: 100vh;
            padding: 0;
            margin: 0;
            display: flex;
            flex-direction: row;
            align-items: stretch;
            font-family: Arial, Helvetica, sans-serif;
        }
        aside{
            background-color: rgb(231, 233, 238);
            flex-basis: 300px;
            overflow: auto;
        }
        main{
            flex: 1;
            padding: 16px;
            overflow: auto;
        }
        #details{
            border: 1px solid;
            padding: 16px;
            margin: 8px;
            white-space: pre;
        }

    </style>
</head>
<body>
    <aside></aside>
    <main>
        <h1>Rector√≠a, Piso 4</h1>
        <div id="container" style="position: relative;">
            <floor-map src="./test2.json" date="2022-01-29T04:00:00.000Z"></floor-map>

            <popup-window id="test" x="100px" y="3%" style="position: absolute;">
                <div style="background: rgba(255, 255, 255, 0.9); border: 1px solid; padding: 16px; height: 60px; width: 40px; backdrop-filter: blur(80px);"></div>
            </popup-window>

        </div>
    </main>
    <script>
        function getCoordinatePercentages(x, y, parent){
            return {
                x: (x - parent.getBoundingClientRect().x)/parent.getBoundingClientRect().width, 
                y: (y - parent.getBoundingClientRect().y)/parent.getBoundingClientRect().height
            }
        }
        document.querySelector('floor-map').addEventListener('select', e=>{
            const {x, y} = e.detail.center;
            const percentageCoords = getCoordinatePercentages(x, y, document.querySelector('#container'));
            document.querySelector('#test').show()
            document.querySelector('#test').setAttribute('x', percentageCoords.x*100+'%')
            document.querySelector('#test').setAttribute('y', percentageCoords.y*100+'%')
        })
        /* function getPercentageCoords(x, y, parent){
            return [
                (x - parent.getBoundingClientRect().x)/parent.getBoundingClientRect().width,
                (y - parent.getBoundingClientRect().y)/parent.getBoundingClientRect().height,
            ]
        }
        document.querySelector('floor-map').addEventListener('select', e=>{
            const {x, y} = e.detail.center;
            const percentage = getPercentageCoords(x, y, document.querySelector('floor-map'));
            document.querySelector('#test').setAttribute('left', percentage[0]*100 + "%")
            document.querySelector('#test').setAttribute('right', percentage[1]*100 + "%")
        }) */
    </script>

    <script src="./floor-map.js" type="module"></script>
    <script src="./popup-window.js" type="module"></script>
</body>
</html>